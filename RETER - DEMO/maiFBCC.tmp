[gd_scene load_steps=23 format=3 uid="uid://cifspwsgpk0fk"]

[ext_resource type="Script" path="res://script/main.gd" id="1_3c0e4"]
[ext_resource type="Script" path="res://script/cameraControl.gd" id="2_5fg2g"]
[ext_resource type="MeshLibrary" uid="uid://5briv1ieb4eh" path="res://toutes_assiettes.meshlib" id="3_03pjp"]
[ext_resource type="Script" path="res://script/fpsCounter.gd" id="4_1y2p2"]
[ext_resource type="Script" path="res://script/BuildModUI.gd" id="4_mhipu"]
[ext_resource type="Script" path="res://script/WarningWindow.gd" id="5_8uh2o"]
[ext_resource type="Texture2D" uid="uid://nno2rn10kxqs" path="res://images/icon.svg" id="5_e1300"]
[ext_resource type="Script" path="res://script/TextureButton.gd" id="6_56kq6"]
[ext_resource type="Texture2D" uid="uid://bkxpvoaoqad4v" path="res://images/UNGO.png" id="6_74mwb"]
[ext_resource type="Texture2D" uid="uid://l3dbd7pumuut" path="res://images/RETER.png" id="7_5dydq"]
[ext_resource type="Script" path="res://script/BuildingInfoWindow.gd" id="7_77ygr"]
[ext_resource type="AudioStream" uid="uid://bemi4jxjj2hly" path="res://audio/construction_sound.mp3" id="8_p6b3a"]
[ext_resource type="AudioStream" uid="uid://d53ulffdx5em" path="res://audio/destruction_sound.mp3" id="9_b1gik"]
[ext_resource type="ArrayMesh" uid="uid://beebl83skhfu1" path="res://Assets_City/obj/building_4.obj" id="10_hausl"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_e6rni"]
albedo_color = Color(0.478431, 1, 0.0784314, 1)

[sub_resource type="BoxShape3D" id="BoxShape3D_0stvd"]
size = Vector3(20, 1, 20)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_ltt14"]
albedo_color = Color(0.207843, 0.529412, 0, 1)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_twysu"]
albedo_color = Color(0.188235, 1, 1, 1)

[sub_resource type="StyleBoxFlat" id="StyleBoxFlat_pjmwo"]
bg_color = Color(0.580392, 0.643137, 0.0156863, 1)

[sub_resource type="Animation" id="Animation_2dpk1"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("TopRecangle:color")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Color(0, 0, 0, 1)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("BottomRectangle:color")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Color(0, 0, 0, 1)]
}

[sub_resource type="Animation" id="Animation_afypu"]
resource_name = "credits"
length = 3.0
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("TopRecangle:color")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 1),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Color(0, 0, 0, 1), Color(0, 0, 0, 0)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("BottomRectangle:color")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 1, 1.6),
"transitions": PackedFloat32Array(1, 1, 1),
"update": 0,
"values": [Color(0, 0, 0, 1), Color(0, 0, 0, 1), Color(0, 0, 0, 0)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_38b2v"]
_data = {
"RESET": SubResource("Animation_2dpk1"),
"credits": SubResource("Animation_afypu")
}

[node name="main" type="Node3D"]
script = ExtResource("1_3c0e4")

[node name="DirectionalLight3D" type="DirectionalLight3D" parent="."]
transform = Transform3D(-0.866024, -0.433016, 0.250001, 0, 0.499998, 0.866026, -0.500003, 0.749999, -0.43301, 0, 37.4949, 0)
shadow_enabled = true

[node name="firstPivot" type="Marker3D" parent="."]
script = ExtResource("2_5fg2g")

[node name="secondPivot" type="Marker3D" parent="firstPivot"]

[node name="camera" type="Camera3D" parent="firstPivot/secondPivot"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 10, 15)
current = true

[node name="Ground" type="StaticBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.5, 0)

[node name="CSGBox3D" type="CSGBox3D" parent="Ground"]
material_override = SubResource("StandardMaterial3D_e6rni")
size = Vector3(30, 1, 30)

[node name="CollisionShape3D" type="CollisionShape3D" parent="Ground"]
transform = Transform3D(1.5, 0, 0, 0, 1.5, 0, 0, 0, 1.5, 0, 0, 0)
shape = SubResource("BoxShape3D_0stvd")

[node name="GridMap" type="GridMap" parent="."]
mesh_library = ExtResource("3_03pjp")
cell_size = Vector3(2, 1, 2)
cell_center_y = false
data = {
"cells": PackedInt32Array(8, 65529, 655411, 8, 65530, 655411, 8, 65531, 655411, 8, 65533, 655411, 8, 65532, 655411, 8, 0, 655411, 8, 65535, 655411, 8, 1, 655411, 8, 65534, 655411, 8, 2, 655411, 8, 3, 655411, 8, 4, 655411, 8, 5, 655411, 8, 6, 655411, 8, 7, 655411, 8, 8, 655410, 7, 8, 1441843, 6, 8, 1441843, 5, 8, 1441843, 4, 8, 1441843, 3, 8, 1441843, 2, 8, 1441843, 65530, 8, 1441843, 65531, 8, 1441843, 65533, 8, 1441843, 65532, 8, 1441843, 1, 8, 1441843, 65534, 8, 1441843, 0, 8, 1441843, 65535, 8, 1441843, 65529, 8, 1441843, 65528, 8, 1441843, 8, 65527, 655410, 8, 65528, 655411, 7, 65527, 1048627, 6, 65527, 1048627, 5, 65527, 1048627, 4, 65527, 1048627, 3, 65527, 1048627, 65532, 65527, 1048627, 65533, 65527, 1048627, 65534, 65527, 1048627, 65535, 65527, 1048627, 0, 65527, 1048627, 1, 65527, 1048627, 2, 65527, 1048627, 65531, 65527, 1048627, 65530, 65527, 1048627, 65529, 65527, 1048627, 65528, 65527, 1048627, 65527, 65527, 50, 65527, 65528, 51, 65527, 65529, 51, 65527, 65530, 51, 65527, 65531, 51, 65527, 65532, 51, 65527, 65533, 51, 65527, 65534, 51, 65527, 65535, 51, 65527, 0, 51, 65527, 1, 51, 65527, 2, 51, 65527, 3, 51, 65527, 4, 51, 65527, 5, 655411, 65527, 6, 655411, 65527, 7, 655411, 65527, 8, 655410)
}

[node name="Decor" type="CSGBox3D" parent="."]
transform = Transform3D(520.615, 0, 0, 0, 1.9356, 0, 0, 0, 590.365, 0, -0.99, 3.58364)
material = SubResource("StandardMaterial3D_ltt14")

[node name="Skybox" type="CSGSphere3D" parent="."]
material_override = SubResource("StandardMaterial3D_twysu")
flip_faces = true
radius = 100.0

[node name="Lighting" type="OmniLight3D" parent="Skybox"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 48.4704, 0)
omni_range = 500.0
omni_attenuation = 0.0150927

[node name="UI" type="Control" parent="."]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
size_flags_vertical = 4
mouse_filter = 2

[node name="BuildModUI" type="Control" parent="UI"]
visible = false
anchors_preset = 0
offset_right = 40.0
offset_bottom = 40.0
mouse_filter = 1
script = ExtResource("4_mhipu")

[node name="TabBar" type="TabBar" parent="UI/BuildModUI"]
layout_mode = 0
offset_top = 891.0
offset_right = 1728.0
offset_bottom = 931.0
tab_count = 2
tab_0/title = "Simple Buildings"
tab_1/title = "Complex Buidling"

[node name="SimpleBuilding" type="Panel" parent="UI/BuildModUI"]
layout_mode = 0
offset_top = 931.0
offset_right = 1728.0
offset_bottom = 1081.0
mouse_filter = 1
metadata/tag = 0

[node name="TextureButton" type="TextureButton" parent="UI/BuildModUI/SimpleBuilding"]
layout_mode = 0
offset_left = 18.0
offset_top = 9.0
offset_right = 146.0
offset_bottom = 137.0
texture_normal = ExtResource("5_e1300")
script = ExtResource("6_56kq6")
metadata/index = 4

[node name="TextureButton2" type="TextureButton" parent="UI/BuildModUI/SimpleBuilding"]
layout_mode = 0
offset_left = 176.0
offset_top = 9.0
offset_right = 304.0
offset_bottom = 137.0
texture_normal = ExtResource("5_e1300")
script = ExtResource("6_56kq6")
metadata/index = 6

[node name="TextureButton3" type="TextureButton" parent="UI/BuildModUI/SimpleBuilding"]
layout_mode = 0
offset_left = 334.0
offset_top = 9.0
offset_right = 462.0
offset_bottom = 137.0
texture_normal = ExtResource("5_e1300")
script = ExtResource("6_56kq6")
metadata/index = 8

[node name="TextureButton4" type="TextureButton" parent="UI/BuildModUI/SimpleBuilding"]
layout_mode = 0
offset_left = 492.0
offset_top = 9.0
offset_right = 620.0
offset_bottom = 137.0
texture_normal = ExtResource("5_e1300")
script = ExtResource("6_56kq6")
metadata/index = 10

[node name="TextureButton5" type="TextureButton" parent="UI/BuildModUI/SimpleBuilding"]
layout_mode = 0
offset_left = 650.0
offset_top = 9.0
offset_right = 778.0
offset_bottom = 137.0
texture_normal = ExtResource("5_e1300")
script = ExtResource("6_56kq6")
metadata/index = 12

[node name="TextureButton6" type="TextureButton" parent="UI/BuildModUI/SimpleBuilding"]
layout_mode = 0
offset_left = 808.0
offset_top = 9.0
offset_right = 936.0
offset_bottom = 137.0
texture_normal = ExtResource("5_e1300")
script = ExtResource("6_56kq6")
metadata/index = 14

[node name="TextureButton7" type="TextureButton" parent="UI/BuildModUI/SimpleBuilding"]
layout_mode = 0
offset_left = 963.0
offset_top = 9.0
offset_right = 1091.0
offset_bottom = 137.0
texture_normal = ExtResource("5_e1300")
script = ExtResource("6_56kq6")
metadata/index = 16

[node name="SelectedBuldingLabel" type="Label" parent="UI/BuildModUI"]
layout_mode = 0
offset_left = 5.0
offset_top = 39.0
offset_right = 258.0
offset_bottom = 126.0

[node name="DestructionModUI" type="Control" parent="UI"]
visible = false
anchors_preset = 0
offset_right = 40.0
offset_bottom = 40.0

[node name="PnlDestruction" type="Panel" parent="UI/DestructionModUI"]
layout_mode = 0
offset_left = 345.0
offset_top = 20.0
offset_right = 815.0
offset_bottom = 114.0
theme_override_styles/panel = SubResource("StyleBoxFlat_pjmwo")

[node name="LblDestruction" type="Label" parent="UI/DestructionModUI/PnlDestruction"]
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -214.5
offset_top = -39.0
offset_right = 214.5
offset_bottom = 39.0
grow_horizontal = 2
grow_vertical = 2
theme_override_colors/font_color = Color(1, 1, 1, 1)
theme_override_font_sizes/font_size = 22
text = "Mode DESTRUCTION : 
Cliquer sur un bâtiment pour le détruire"
horizontal_alignment = 1

[node name="FPSLabel" type="RichTextLabel" parent="UI"]
layout_mode = 0
offset_left = 7.0
offset_right = 106.0
offset_bottom = 40.0
script = ExtResource("4_1y2p2")

[node name="BuildModButton" type="Button" parent="UI"]
layout_mode = 1
anchors_preset = -1
anchor_left = 0.5
anchor_top = 0.964
anchor_right = 0.5
anchor_bottom = 0.964
offset_left = 790.0
offset_top = -104.12
offset_right = 936.0
offset_bottom = -17.12
theme_override_colors/font_color = Color(1, 1, 1, 1)
theme_override_colors/icon_hover_color = Color(0.72549, 0.054902, 0.529412, 1)
text = "CONSTRUCTION"

[node name="BtnModeDesctruction" type="Button" parent="UI"]
layout_mode = 0
offset_left = 1750.0
offset_top = 1027.0
offset_right = 1896.0
offset_bottom = 1058.0
text = "DESTRUCTION"

[node name="WarningWindow" type="Window" parent="UI"]
title = "Construction impossible"
initial_position = 1
size = Vector2i(300, 120)
visible = false
theme_override_colors/title_color = Color(0.886275, 0.298039, 0.360784, 1)
script = ExtResource("5_8uh2o")

[node name="ValideButton" type="Button" parent="UI/WarningWindow"]
anchors_preset = 12
anchor_top = 1.0
anchor_right = 1.0
anchor_bottom = 1.0
offset_top = -31.0
grow_horizontal = 2
grow_vertical = 0
size_flags_horizontal = 4
size_flags_vertical = 8
text = "OK C BON G KOMPRI"

[node name="WarningLabel" type="Label" parent="UI/WarningWindow"]
anchors_preset = 10
anchor_right = 1.0
offset_bottom = 52.0
grow_horizontal = 2
size_flags_horizontal = 4
text = "Attention, un bâtiment est déjà construit sur ce lieu. Veulliez en choisir un autre."
horizontal_alignment = 1
autowrap_mode = 2
justification_flags = 139

[node name="BuildingInfoWindow" type="Window" parent="UI"]
title = "Informations sur un bâtiments"
initial_position = 1
size = Vector2i(320, 300)
visible = false
script = ExtResource("7_77ygr")

[node name="Mesh" type="MeshInstance2D" parent="UI/BuildingInfoWindow"]
position = Vector2(150, 230)
rotation = 3.14159
scale = Vector2(60, 60)
mesh = ExtResource("10_hausl")

[node name="CloseButton" type="Button" parent="UI/BuildingInfoWindow"]
anchors_preset = 12
anchor_top = 1.0
anchor_right = 1.0
anchor_bottom = 1.0
offset_top = -31.0
grow_horizontal = 2
grow_vertical = 0
text = "Fermer"

[node name="InfoLabel" type="Label" parent="UI/BuildingInfoWindow"]
anchors_preset = 10
anchor_right = 1.0
offset_bottom = 26.0
grow_horizontal = 2
text = "Batiment selectionné : "
horizontal_alignment = 1
vertical_alignment = 2

[node name="Transitions" type="Node" parent="."]

[node name="Credits" type="CanvasLayer" parent="Transitions"]
visible = false

[node name="TopRecangle" type="ColorRect" parent="Transitions/Credits"]
z_index = 2
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_bottom = -542.0
grow_horizontal = 2
grow_vertical = 2
color = Color(0, 0, 0, 1)

[node name="BottomRectangle" type="ColorRect" parent="Transitions/Credits"]
z_index = 2
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
offset_top = 533.0
grow_horizontal = 2
grow_vertical = 2
color = Color(0, 0, 0, 1)

[node name="UngoLogo" type="TextureRect" parent="Transitions/Credits"]
z_index = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -140.0
offset_top = -224.0
offset_right = 140.0
offset_bottom = 56.0
grow_horizontal = 2
grow_vertical = 2
texture = ExtResource("6_74mwb")
expand_mode = 3

[node name="ReterLogo" type="TextureRect" parent="Transitions/Credits"]
z_index = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -265.814
offset_top = -24.0
offset_right = 265.814
offset_bottom = 156.0
grow_horizontal = 2
grow_vertical = 2
texture = ExtResource("7_5dydq")
expand_mode = 3

[node name="BackGroundRectangle" type="ColorRect" parent="Transitions/Credits"]
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
color = Color(0, 0, 0, 1)

[node name="AnimationPlayer" type="AnimationPlayer" parent="Transitions/Credits"]
libraries = {
"": SubResource("AnimationLibrary_38b2v")
}

[node name="Sounds" type="Node" parent="."]

[node name="ConstructionSound" type="AudioStreamPlayer2D" parent="Sounds"]
stream = ExtResource("8_p6b3a")
volume_db = 11.458

[node name="DestructionSound" type="AudioStreamPlayer2D" parent="Sounds"]
stream = ExtResource("9_b1gik")
volume_db = -14.101

[connection signal="input_event" from="Ground" to="." method="_on_static_body_3d_input_event"]
[connection signal="input_event" from="Ground" to="firstPivot" method="_on_static_body_3d_input_event"]
[connection signal="tab_selected" from="UI/BuildModUI/TabBar" to="UI/BuildModUI" method="_on_tab_bar_tab_selected"]
[connection signal="pressed" from="UI/BuildModUI/SimpleBuilding/TextureButton" to="UI/BuildModUI/SimpleBuilding/TextureButton" method="_on_pressed"]
[connection signal="pressed" from="UI/BuildModUI/SimpleBuilding/TextureButton2" to="UI/BuildModUI/SimpleBuilding/TextureButton" method="_on_pressed"]
[connection signal="pressed" from="UI/BuildModUI/SimpleBuilding/TextureButton3" to="UI/BuildModUI/SimpleBuilding/TextureButton3" method="_on_pressed"]
[connection signal="pressed" from="UI/BuildModUI/SimpleBuilding/TextureButton4" to="UI/BuildModUI/SimpleBuilding/TextureButton4" method="_on_pressed"]
[connection signal="pressed" from="UI/BuildModUI/SimpleBuilding/TextureButton5" to="UI/BuildModUI/SimpleBuilding/TextureButton5" method="_on_pressed"]
[connection signal="pressed" from="UI/BuildModUI/SimpleBuilding/TextureButton6" to="UI/BuildModUI/SimpleBuilding/TextureButton6" method="_on_pressed"]
[connection signal="pressed" from="UI/BuildModUI/SimpleBuilding/TextureButton7" to="UI/BuildModUI/SimpleBuilding/TextureButton7" method="_on_pressed"]
[connection signal="pressed" from="UI/BuildModButton" to="." method="_on_build_mod_button_pressed"]
[connection signal="pressed" from="UI/BtnModeDesctruction" to="." method="_on_btn_mode_desctruction_pressed"]
[connection signal="close_requested" from="UI/WarningWindow" to="UI/WarningWindow" method="_on_close_requested"]
[connection signal="pressed" from="UI/WarningWindow/ValideButton" to="UI/WarningWindow" method="_on_valide_button_pressed"]
[connection signal="close_requested" from="UI/BuildingInfoWindow" to="UI/BuildingInfoWindow" method="_on_close_requested"]
[connection signal="pressed" from="UI/BuildingInfoWindow/CloseButton" to="UI/BuildingInfoWindow" method="_on_close_button_pressed"]
[connection signal="animation_finished" from="Transitions/Credits/AnimationPlayer" to="." method="_on_animation_player_animation_finished"]
